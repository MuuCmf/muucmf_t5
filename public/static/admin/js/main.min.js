"use strict";$(function(){$(".ajax-get").click(function(){var e,t=this;return $(this).hasClass("confirm")&&!confirm("确认要执行该操作吗?")||((e=$(this).attr("href"))||(e=$(this).attr("url")))&&$.get(e).success(function(e){1==e.status?(e.url?updateAlert(e.info+" 页面即将自动跳转~","success"):updateAlert(e.info,"success"),setTimeout(function(){e.url?location.href=e.url:$(t).hasClass("no-refresh")?$("#top-alert").find("button").click():location.reload()},3e3)):(updateAlert(e.info),setTimeout(function(){e.url?location.href=e.url:$("#top-alert").find("button").click()},15e3))}),!1}),$(".ajax-post").click(function(){var e,t,n,i=$(this).attr("target-form"),o=this,a=!1;if("submit"==$(this).attr("type")||(e=$(this).attr("href"))||(e=$(this).attr("url"))){if(n=$("."+i),"true"===$(this).attr("hide-data"))t=(n=$(".hide-data")).serialize();else{if(null==n.get(0))return updateAlert("没有可操作数据。","danger"),!1;if("FORM"==n.get(0).nodeName){if($(this).hasClass("confirm"))if(s=(s=$(o).attr("confirm-info"))||"确认要执行该操作吗?",!confirm(s))return!1;e=void 0!==$(this).attr("url")?$(this).attr("url"):n.get(0).action,t=n.serialize()}else if("INPUT"==n.get(0).nodeName||"SELECT"==n.get(0).nodeName||"TEXTAREA"==n.get(0).nodeName){if(n.each(function(e,t){"checkbox"==t.type&&1==t.checked&&(a=!0)}),a&&$(this).hasClass("confirm"))if(s=(s=$(o).attr("confirm-info"))||"确认要执行该操作吗?",!confirm(s))return!1;t=n.serialize()}else{var s;if($(this).hasClass("confirm"))if(s=(s=$(o).attr("confirm-info"))||"确认要执行该操作吗?",!confirm(s))return!1;t=n.find("input,select,textarea").serialize()}}if(""==t&&"true"!=$(this).attr("hide-data"))return updateAlert("请勾选操作对象。","danger"),!1;$(o).addClass("disabled").attr("autocomplete","off").prop("disabled",!0),$.post(e,t).success(function(e){1==e.status?(e.url?updateAlert(e.info+" 页面即将自动跳转~","success"):updateAlert(e.info,"success"),setTimeout(function(){e.url?location.href=e.url:$(o).hasClass("no-refresh")?($("#top-alert").find("button").click(),$(o).removeClass("disabled").prop("disabled",!1)):location.reload()},1500)):(updateAlert(e.info,"error"),setTimeout(function(){e.url?location.href=e.url:($("#top-alert").find("button").click(),$(o).removeClass("disabled").prop("disabled",!1))},1500))})}return!1})});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(l,i,c){if(void 0===l)throw new Error("ZUI requires jQuery");l.zui||(l.zui=function(e){l.isPlainObject(e)&&l.extend(l.zui,e)});var t={all:-1,left:0,middle:1,right:2},e=0;l.zui({uuid:function(){return 1e3*(new Date).getTime()+e++%1e3},callEvent:function(e,t,n){if(l.isFunction(e)){n!==c&&(e=l.proxy(e,n));var i=e(t);return t&&(t.result=i),!(i!==c&&!i)}return 1},clientLang:function(){var e,t=i.config;if(void 0!==t&&t.clientLang&&(e=t.clientLang),!e){var n=l("html").attr("lang");e=n||(navigator.userLanguage||navigator.userLanguage||"zh_cn")}return e.replace("-","_").toLowerCase()},strCode:function(e){var t=0;if(e&&e.length)for(var n=0;n<e.length;++n)t+=n*e.charCodeAt(n);return t},getMouseButtonCode:function(e){return"number"!=typeof e&&(e=t[e]),e!==c&&null!==e||(e=-1),e}}),l.fn.callEvent=function(e,t,n){var i=l(this),o=e.indexOf(".zui."),a=o<0?e:e.substring(0,o),s=l.Event(a,t);if(n===c&&0<o&&(n=i.data(e.substring(o+1))),n&&n.options){var r=n.options[a];l.isFunction(r)&&(s.result=l.zui.callEvent(r,s,n))}return i.trigger(s),s},l.fn.callComEvent=function(e,t,n){n===c||l.isArray(n)||(n=[n]);var i=this.triggerHandler(t,n),o=e.options[t];return o&&(i=o.apply(e,n)),i}}(jQuery,window,void 0),String.prototype.format||(String.prototype.format=function(e){var t,n=this;if(0<arguments.length)if(arguments.length<=2&&"object"==(void 0===e?"undefined":_typeof(e)))for(var i in e)void 0!==e[i]&&(t=new RegExp("("+(arguments[1]?arguments[1].replace("0",i):"{"+i+"}")+")","g"),n=n.replace(t,e[i]));else for(var o=0;o<arguments.length;o++)void 0!==arguments[o]&&(t=new RegExp("({["+o+"]})","g"),n=n.replace(t,arguments[o]));return n}),String.prototype.isNum||(String.prototype.isNum=function(e){var t;return null!==e&&(t=/\d*/i,e.match(t)==e)}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;var i=n.indexOf(e,t);return-1!==i&&i===t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.lastIndexOf(e,t)===t}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),$(function(){$('a[data-id="clear_cache"]').on("click",function(){var e,t,n=$(this).attr("data-msg");e=n,t=new $.zui.Messager(e,{placement:"bottom"}),$.get(Url("admin/common/clear_cache")),t.show()})});var moduleManager={install:function(e){$.post(Url("admin/module/install"),{id:e},function(e){handleAjax(e)})},uninstall:function(e){$.post(Url("admin/module/uninstall"),{id:e},function(e){handleAjax(e)})}};function Url(e,t,n){var i="/index.php";return""!=(e=e.split("/"))[0]&&"@"!=e[0]||(e[0]=APPNAME),e[1]||(e[1]="Index"),e[2]||(e[2]="index"),i=i+"?s=/"+e[0]+"/"+e[1]+"/"+e[2],t&&(i=i+"/"+(t=t.join("/"))),n||(i+=".html"),i}function handleAjax(e){alert(e),e.url&&(e.info+="，页面即将跳转～"),e.status?updateAlert(e.info,"success"):updateAlert(e.info,"danger");"refresh"==e.url?setTimeout(function(){location.href=location.href},1500):e.url&&setTimeout(function(){location.href=e.url},1500)}$(function(){$(".main-header").on("click","#full-screen",function(){var e,t;document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(t=document).webkitCancelFullScreen?t.webkitCancelFullScreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.cancelFullScreen?t.cancelFullScreen():t.exitFullscreen?t.exitFullscreen():notice.notice_show("浏览器不支持全屏API或已被禁用",null,null,null,!0,!0):(e=document.body).webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.requestFullScreen?e.requestFullscreen():notice.notice_show("浏览器不支持全屏API或已被禁用",null,null,null,!0,!0)})}),$(function(){$(".check-all").click(function(){$(".ids").prop("checked",this.checked)}),$(".ids").click(function(){$(".ids").each(function(e){if(!this.checked)return $(".check-all").prop("checked",!1),!1;$(".check-all").prop("checked",!0)})});$("#main");var e=$("#top-alert");e.find(".close").on("click",function(){e.removeClass("block").slideUp(200)}),window.updateAlert=function(e,t){if(void 0!==t)var n=$.zui.messager.show(e,{placement:"bottom",type:t});else n=$.zui.messager.show(e,{placement:"bottom"});n.show()},$(".text").focus(function(){$(this).addClass("focus")}).blur(function(){$(this).removeClass("focus")}),$("textarea").focus(function(){$(this).closest(".textarea").addClass("focus")}).blur(function(){$(this).closest(".textarea").removeClass("focus")})});var admin_image={removeImage:function(e,t){this.upAttachVal("del",t,e),e.parents(".each").remove()},upAttachVal:function(e,t,n){var i=n.parents(".controls").find(".attach"),o=i.val().split(","),a=[];for(var s in o)""!==o[s]&&o[s]!==t.toString()&&a.push(o[s]);return"add"===e&&a.push(t),i.val(a.join(",")),a}};!function(c,u,d){var l=0,f={type:"default",placement:"top",time:4e3,parent:"body",icon:null,close:!0,fade:!0,scale:!0},h={},i=function(e,n){c.isPlainObject(e)&&(e=(n=e).message);var i=this;n=i.options=c.extend({},f,n),i.id=n.id||l++;var t=h[i.id];t&&t.destroy(),(h[i.id]=i).message=(n.icon?'<i class="icon-'+n.icon+' icon"></i> ':"")+e,i.$=c('<div class="messager messager-{type} {placement}" style="display: none"><div class="messager-content"></div><div class="messager-actions"></div></div>'.format(n)).toggleClass("fade",n.fade).toggleClass("scale",n.scale).attr("id","messager-"+i.id),n.cssClass&&i.$.addClass(n.cssClass);var o=!1,a=i.$.find(".messager-actions"),s=function(e){var t=c('<button type="button" class="action action-'+e.name+'"/>');"close"===e.name&&t.addClass("close"),e.html!==d&&t.html(e.html),e.icon!==d&&t.append('<i class="action-icon icon-'+e.icon+'"/>'),e.text!==d&&t.append('<span class="action-text">'+e.text+"</span>"),e.tooltip!==d&&t.attr("title",e.tooltip).tooltip(),t.data("action",e),a.append(t)};n.actions&&c.each(n.actions,function(e,t){t.name===d&&(t.name=e),"close"==t.name&&(o=!0),s(t)}),!o&&n.close&&s({name:"close",html:"&times;"}),i.$.on("click",".action",function(e){var t=c(this).data("action");n.onAction&&!1===n.onAction.call(this,t.name,t,i)||c.isFunction(t.action)&&!1===t.action.call(this,i)||(i.hide(),e.stopPropagation())}),i.$.on("click",function(e){n.onAction&&(!0===n.onAction.call(this,"content",null,i)&&i.hide())});var r=i.$.find(".messager-content").html(i.message);n.contentClass&&r.addClass(n.contentClass),i.$.data("zui.messager",i),n.show&&i.message!==d&&i.show()};i.prototype.update=function(e,t){var n=this,i=n.options;n.$.removeClass("messager-"+i.type),t&&(i=c.extend(i,t)),n.$.addClass("messager-"+i.type),e&&(n.message=(i.icon?'<i class="icon-'+i.icon+' icon"></i> ':"")+e,n.$.find(".messager-content").html(n.message))},i.prototype.show=function(e,t){var n=this,i=this.options;if(c.isFunction(e)){var o=t;t=e,o!==d&&(e=o)}if(!n.isShow){n.hiding&&(clearTimeout(n.hiding),n.hiding=null),n.update(e);var a=i.placement,s=c(i.parent),r=s.children(".messagers-holder."+a);if(r.length||(r=c("<div/>").attr("class","messagers-holder "+a).appendTo(s)),r.append(n.$),"center"===a){var l=c(u).height()-r.height();r.css("top",Math.max(-l,l/2))}return n.$.show().addClass("in"),i.time&&(n.hiding=setTimeout(function(){n.hide()},i.time)),n.isShow=!0,t&&t(),n}n.hide(function(){n.show(e,t)})},i.prototype.hide=function(t,e){!0===t&&(e=!0,t=null);var n=this;if(n.$.hasClass("in")){n.$.removeClass("in");var i=function(){var e=n.$.parent();n.$.detach(),e.children().length||e.remove(),t&&t(!0)};e?i():setTimeout(i,200)}else t&&t(!1);n.isShow=!1},i.prototype.destroy=function(){var e=this;e.hide(function(){e.$.remove(),e.$=null},!0),delete h[e.id]},i.all=h;var o=function(){c(".messager").each(function(){var e=c(this).data("zui.messager");e&&e.hide&&e.hide(!0)})},a=function(e,t){"string"==typeof t&&(t={type:t}),(t=c.extend({},t)).id===d&&o();var n=h[t.id]||new i(e,t);return n.show(),n},e={show:a,hide:o};c.each({primary:0,success:"ok-sign",info:"info-sign",warning:"warning-sign",danger:"exclamation-sign",important:0,special:0},function(i,o){e[i]=function(e,t){return a(e,c.extend({type:i,icon:o||null},"string"==typeof(n=t)?{placement:n}:n));var n}}),c.zui({Messager:i,showMessager:a,messager:e})}(jQuery,window,void 0),$(function(){var e=$('[data-toggle="can_update"]').val(),t=$('[data-toggle="version"]').val();1==e&&$.get("http://www.muucmf.cn/index.php?s=muucmf/sysupdate/index/enable_version/"+t,function(e){e.status&&new $.zui.Messager("有新的版本更新！",{type:"danger",icon:"bell",placement:"bottom",time:1e4,actions:[{name:"update",icon:"chevron-right",text:"去更新",action:function(){return!(window.location.href="index.php?s=admin/update/index.html")}}]}).show()})});